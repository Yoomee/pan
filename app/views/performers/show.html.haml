.row
  .span3
    .row.profile-left-col
      .span3
        =image_for(performer, "220x") if performer.image
      .span3.mt-2
        %h4=pluralize(22, 'Review')
        %table.unstyled
          %tr
            %td Excellent
            %td
              -3.times do
                %i.icon.icon-star
          %tr
            %td Very good
            %td
              -1.times do
                %i.icon.icon-star
          %tr
            %td Average
          %tr
            %td Poor
          %tr
            %td Terrible
      -if !performer.links.empty?
        .span3.mt-2
          %h4 Links
          %ul.unstyled.links
            -performer.links.each do |link|
              %li
                =image_tag(link.favicon)
                =link_to(link, link.url, :target => '_blank')
      -if performer.contact1_details.present?
        .span3.mt-2
          %h4 Primary contact
          =auto_link(performer.contact1_details.join("<br />").html_safe)
      -if performer.contact2_details.present?
        .span3.mt-2
          %h4 Secondary contact
          =auto_link(performer.contact2_details.join("<br />").html_safe)
      -if future_tour = performer.tours.future.first
        .span3.mt-2
          %h4 Upcoming shows
          %ul.unstyled
            -future_tour.dates.where(:booked => true).future.each do |tour_date|
              %li
                =tour_date.date.to_s(:month_day_year_or_not)
                -if tour_date.venue
                  \-
                  =link_to_self(tour_date.venue)
                -elsif tour_date.external_venue_name.present?
                  ="- #{tour_date.external_venue_name}"
          =link_to("View all future shows", performer_tours_path(performer, :anchor => 'future'))
      -if !performer.tours.past.empty?
        .span3.mt-2
          %h4 Past shows
          =link_to("View all past shows", performer_tours_path(performer, :anchor => 'past'))
        

        
  .span7
    %h1.mb-1=title(performer)
  .span2
    =link_to('&uarr; All performers'.html_safe, performers_path, :class => "back-to-all")
  .span9=render('organisations/notes', :organisation => performer)
  .span9
    -if performer.slideshow    
      %ul.nav.nav-tabs
        %li.active
          =link_to("Profile", "#profile", :data => {:toggle => "tab"})
        %li
          =link_to("Photo gallery", "#gallery", :data => {:toggle => "tab"})
    .tab-content
      #profile.tab-pane.fade.in.active
        =simple_format(performer.description)
        .row.company_tag_lists
          -if current_tour = performer.tours.first
            .span2.mb-1
              %h4 Current show:
              =link_to_self(current_tour)
          -if performer.genre_list.present?
            .span2.mb-1
              %h4 Genres
              %ul.unstyled
                -performer.genre_list.each do |genre|
                  %li=link_to(genre.titleize.humanize, tag_performers_path('genres',genre))
          -if performer.art_form_list.present?
            .span2.mb-1
              %h4 Art forms
              %ul.unstyled
                -performer.art_form_list.each do |art_form|
                  %li=art_form.titleize.humanize
          -if performer.funder_list.present?
            .span2.mb-1
              %h4 Funders
              %ul.unstyled
                -performer.funder_list.each do |funder|
                  %li=funder.titleize.humanize
          -if performer.work_scale_list.present?
            .span2.mb-1
              %h4 Scale of work
              %ul.unstyled
                -performer.work_scale_list.each do |work_scale|
                  %li=work_scale.titleize.humanize
        .row.mt-2    
          -if (media_posts = performer.posts.where("image_uid LIKE '%'").limit(8)).present?
            .span4
              %h4 Photos/videos
              .row.mt-1
                -media_posts.each do |media_post|
                  .span1.mb-1
                    =link_to("#", :data => {:toggle => "modal", :backdrop => false, :"modal-url" => modal_post_path(media_post), :"modal-id" => "post_modal"}) do
                      =image_for(media_post, '60x60#', :class => "#{media_post.has_video? ? 'video-image' : ''}")
          .span4{:class => "#{media_posts.present? ? 'offset1' : ''}"}
            %h4 Venues regularly visited
            .row.mt-1
              -performer.venues.each do |venue|
                .span1.mb-1
                  =link_to(image_for(venue, "60x60#"), venue)
                  =link_to_self(venue, :class => "small-info-text")
        .row.mt-2
          .span9
            %h4 Proposed tour dates
            .row.mt-1
              -performer.tour_dates.future.each do |tour_date|
                .span1.mb-1
                  =link_to(image_for(tour_date.tour, "60x60#"), tour_date.tour)
                  %span.small-info-text=tour_date.date.to_s(:date)
        =render("organisations/facebook_twitter", :organisation => performer)
    
        -if posts.present? || can?(:create, Post)
          .row.mt-2
            .span9
              %h4.mb-1 Updates
              -if can?(:create, Post)
                =render("posts/remote_form", :post => current_user.posts.build(:target => performer))
              =render("posts/posts", :posts => posts)
        
      -if performer.slideshow
        #gallery.tab-pane.fade
          .span9
            =render("organisations/slideshow", :slideshow => performer.slideshow)
    
.row.mt-2
  .span9
    =options_panel do
      =back_link
      =link_if_can("Edit performer", [:edit, performer])
      -if can?(:new, performer.tours.build)
        =link_to("Manage tours", performer_tours_path(performer, :anchor => 'all'))
        =link_to("Add tour", new_performer_tour_path(performer))
      =link_if_can("Delete performer", [:destroy, performer], :confirm => "Are you sure?")
    -if params[:modal] == "welcome" && current_user.try(:performer) == performer
      =render("welcome_modal", :performer => performer)